<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional EMI Calculator</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <!-- Font Awesome for external link icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            padding: 0;
        }
        .welcome {
            text-align: center;
            font-size: 26px;
            margin: 20px 0;
        }
        .container {
            max-width: 900px;
            margin: 20px auto;
            background-color: #fff;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-radius: 10px;
            position: relative;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 25px;
        }
        .input-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .input-group {
            display: flex;
            flex-direction: column;
        }
        .input-group label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #34495e;
        }
        .input-group input {
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 6px;
        }
        .btn {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            background-color: #27ae60;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: 0.3s;
        }
        .btn:hover {
            background-color: #2ecc71;
        }
        #result {
            margin-top: 30px;
        }
        .summary {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 6px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            max-width: 260px;
            cursor: move;
            position: absolute;
            top: 20px;
            left: 20px;
        }
        .scrollable-table {
            max-height: 320px;
            overflow-y: auto;
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid #ddd;
            padding: 10px;
        }
        th {
            background-color: #2980b9;
            color: white;
        }
        td:first-child {
            text-align: center;
        }
        td {
            text-align: right;
        }
    </style>
</head>
<body>

    <div class="welcome">
        WELL COME<br>Kushal Phuyal
    </div>

    <div class="container">
        <h1>Professional EMI Calculator</h1>

        <div class="input-container">
            <div class="input-group">
                <label for="principal">Principal Amount</label>
                <input type="number" id="principal" placeholder="Enter Principal Amount" required>
            </div>

            <div class="input-group">
                <label for="rate">Annual Interest Rate (%)</label>
                <input type="number" id="rate" step="0.01" placeholder="Enter Interest Rate" required>
            </div>

            <div class="input-group">
                <label for="months">Loan Tenure (Months)</label>
                <input type="number" id="months" placeholder="Enter Loan Tenure" required>
            </div>
        </div>

        <button class="btn" onclick="calculateEMI()">Calculate EMI</button>

        <div id="result">
            <div class="summary" id="summary"></div>
            <div class="scrollable-table" id="tableContainer"></div>
        </div>
    </div>

    <script>
        function calculateEMI() {
            let principal = parseFloat(document.getElementById("principal").value);
            let rate = parseFloat(document.getElementById("rate").value) / 12 / 100;
            let months = parseInt(document.getElementById("months").value);

            if (isNaN(principal) || isNaN(rate) || isNaN(months)) {
                alert("Please enter valid input.");
                return;
            }

            let emi = principal * rate * Math.pow(1 + rate, months) / (Math.pow(1 + rate, months) - 1);
            let totalInterest = emi * months - principal;
            let serviceCharge = principal * 0.013;
            let insuranceCharge = principal * 0.00425 * Math.ceil(months / 12);
            let totalCharges = serviceCharge + insuranceCharge;
            let totalCost = principal + totalInterest + totalCharges;

            let remainingPrincipal = principal;
            let startDate = new Date();

            document.getElementById("summary").innerHTML = `
                <h3>EMI Summary</h3>
                <p>Monthly EMI: <strong>${emi.toFixed(2)}</strong></p>
                <p>Total Interest: <strong>${totalInterest.toFixed(2)}</strong></p>
                <p>Service Charge (1.3%): <strong>${serviceCharge.toFixed(2)}</strong></p>
                <p>Insurance Charge (0.425% per year): <strong>${insuranceCharge.toFixed(2)}</strong></p>
                <p>Total Charges (Service + Insurance): <strong>${totalCharges.toFixed(2)}</strong></p>
                <p>Total Cost: <strong>${totalCost.toFixed(2)}</strong></p>
            `;

            let table = `<table>
                <tr><th>EMI No.</th><th>Payment Date</th><th>Principal Paid</th><th>Interest Paid</th><th>Total EMI</th></tr>`;

            for (let i = 1; i <= months; i++) {
                let interestPaid = remainingPrincipal * rate;
                let principalPaid = emi - interestPaid;
                remainingPrincipal -= principalPaid;

                let paymentDate = new Date(startDate);
                paymentDate.setMonth(paymentDate.getMonth() + i - 1);
                let formattedDate = paymentDate.toISOString().split("T")[0];

                table += `<tr>
                    <td>${i}</td>
                    <td>${formattedDate}</td>
                    <td>${principalPaid.toFixed(2)}</td>
                    <td>${interestPaid.toFixed(2)}</td>
                    <td>${emi.toFixed(2)}</td>
                </tr>`;
            }

            table += `</table>`;
            document.getElementById("tableContainer").innerHTML = table;
        }

        // Draggable summary
        dragElement(document.getElementById("summary"));

        function dragElement(el) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            el.onmousedown = dragMouseDown;

            function dragMouseDown(e) {
                e = e || window.event;
                e.preventDefault();
                pos3 = e.clientX;
                pos4 = e.clientY;
                document.onmouseup = closeDragElement;
                document.onmousemove = elementDrag;
            }

            function elementDrag(e) {
                e = e || window.event;
                e.preventDefault();
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
                el.style.top = (el.offsetTop - pos2) + "px";
                el.style.left = (el.offsetLeft - pos1) + "px";
            }

            function closeDragElement() {
                document.onmouseup = null;
                document.onmousemove = null;
            }
        }
    </script>

</body>
</html>