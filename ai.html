<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nepal Accounting AI Suite ‚Äì Kushal Phuyal</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
:root{
  --ink:#070810;--card:#0e1428;--card2:#111828;
  --line:rgba(255,255,255,0.07);--glass:rgba(255,255,255,0.04);
  --teal:#00e5cc;--violet:#7c5cfc;--rose:#ff6584;--gold:#ffd166;--green:#06d6a0;
  --text:#d4d8f0;--muted:#5a6080;
}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{background:var(--ink);color:var(--text);font-family:'DM Sans',sans-serif;min-height:100vh;overflow-x:hidden;}
body::before{content:'';position:fixed;inset:0;z-index:0;pointer-events:none;opacity:.03;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23n)'/%3E%3C/svg%3E");}
.blob{position:fixed;border-radius:50%;filter:blur(130px);opacity:.1;pointer-events:none;z-index:0;}
.b1{width:500px;height:500px;background:var(--violet);top:-200px;left:-150px;}
.b2{width:400px;height:400px;background:var(--teal);bottom:-150px;right:-100px;}

/* NAV */
nav{position:fixed;top:0;left:0;right:0;z-index:9999;height:66px;display:flex;align-items:center;
  justify-content:space-between;padding:0 5%;background:rgba(7,8,16,.9);
  backdrop-filter:blur(20px);border-bottom:1px solid var(--line);}
.nav-logo{font-family:'Syne',sans-serif;font-size:1.2rem;font-weight:800;
  letter-spacing:.1em;color:white;text-decoration:none;}
.nav-logo em{color:var(--teal);font-style:normal;}
.nav-back{display:flex;align-items:center;gap:8px;color:var(--muted);text-decoration:none;
  font-size:.875rem;font-weight:500;padding:8px 16px;border-radius:8px;
  border:1px solid var(--line);transition:all .25s;}
.nav-back:hover{color:var(--teal);border-color:var(--teal);transform:translateX(-3px);}

/* LAYOUT */
.layout{display:flex;min-height:100vh;padding-top:66px;}

/* SIDEBAR */
.sidebar{width:240px;flex-shrink:0;background:rgba(14,20,40,.95);border-right:1px solid var(--line);
  position:fixed;top:66px;left:0;bottom:0;overflow-y:auto;z-index:100;padding:20px 0;}
.sidebar::-webkit-scrollbar{width:3px;}
.sidebar::-webkit-scrollbar-thumb{background:rgba(255,255,255,.1);}
.sb-section{margin-bottom:6px;}
.sb-label{font-size:.68rem;font-weight:700;color:var(--muted);text-transform:uppercase;
  letter-spacing:.12em;padding:10px 20px 6px;}
.sb-btn{display:flex;align-items:center;gap:10px;width:100%;padding:10px 20px;
  background:none;border:none;color:var(--muted);font-size:.84rem;font-weight:500;
  cursor:pointer;transition:all .2s;text-align:left;font-family:'DM Sans',sans-serif;
  border-left:2px solid transparent;}
.sb-btn:hover{color:white;background:rgba(255,255,255,.04);}
.sb-btn.active{color:var(--teal);background:rgba(0,229,204,.07);border-left-color:var(--teal);}
.sb-btn i{width:16px;text-align:center;font-size:.85rem;}

/* MAIN */
.main{margin-left:240px;flex:1;padding:30px 4%;position:relative;z-index:1;}

/* PAGE HEADER */
.page-hdr{margin-bottom:32px;}
.eyebrow{font-size:.7rem;font-weight:700;letter-spacing:.15em;text-transform:uppercase;
  color:var(--teal);display:flex;align-items:center;gap:8px;margin-bottom:10px;}
.eyebrow::before{content:'';width:20px;height:1px;background:var(--teal);}
.page-hdr h1{font-family:'Syne',sans-serif;font-size:1.8rem;font-weight:800;color:white;margin-bottom:6px;}
.page-hdr p{color:var(--muted);font-size:.9rem;}

/* TOOL PANELS */
.tool-panel{display:none;}
.tool-panel.active{display:block;}

/* CARDS */
.card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:24px;margin-bottom:20px;}
.card-title{font-family:'Syne',sans-serif;font-size:1rem;font-weight:700;color:white;
  margin-bottom:18px;display:flex;align-items:center;gap:10px;}
.card-title i{color:var(--teal);}

/* FORM ELEMENTS */
.form-grid{display:grid;gap:16px;}
.form-grid.col2{grid-template-columns:1fr 1fr;}
.form-grid.col3{grid-template-columns:1fr 1fr 1fr;}
.fg{display:flex;flex-direction:column;gap:6px;}
.fg label{font-size:.75rem;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:.06em;}
.inp-w{position:relative;}
.inp-w .pfx{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--muted);font-size:.82rem;pointer-events:none;}
.inp-w .sfx{position:absolute;right:12px;top:50%;transform:translateY(-50%);color:var(--muted);font-size:.75rem;pointer-events:none;}
input[type=text],input[type=number],input[type=date],input[type=email],select,textarea{
  width:100%;padding:11px 14px;background:rgba(0,0,0,.3);border:1px solid var(--line);
  border-radius:10px;color:white;outline:none;font-family:'DM Sans',sans-serif;
  font-size:.9rem;transition:border-color .25s;}
input[type=text]:focus,input[type=number]:focus,input[type=date]:focus,
input[type=email]:focus,select:focus,textarea:focus{border-color:var(--teal);}
input::placeholder,textarea::placeholder{color:var(--muted);}
input::-webkit-inner-spin-button{-webkit-appearance:none;}
select option{background:#111828;color:white;}
.has-pfx input{padding-left:36px;}
.has-sfx input{padding-right:60px;}
input[type=range]{padding:0;border:none;background:none;}

/* BUTTONS */
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;
  padding:11px 24px;border-radius:10px;font-weight:600;font-size:.875rem;
  font-family:'DM Sans',sans-serif;cursor:pointer;border:none;transition:all .25s;}
.btn-teal{background:var(--teal);color:var(--ink);}
.btn-teal:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,229,204,.3);}
.btn-violet{background:var(--violet);color:white;}
.btn-violet:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(124,92,252,.3);}
.btn-ghost{background:rgba(255,255,255,.05);border:1px solid var(--line);color:var(--muted);}
.btn-ghost:hover{border-color:var(--teal);color:var(--teal);}
.btn-row{display:flex;gap:10px;flex-wrap:wrap;margin-top:18px;}

/* RESULT BOX */
.result-box{margin-top:18px;padding:18px;background:rgba(0,229,204,.06);
  border:1px solid rgba(0,229,204,.2);border-radius:12px;display:none;}
.result-box.show{display:block;}
.result-box .res-title{font-size:.72rem;font-weight:700;color:var(--teal);
  text-transform:uppercase;letter-spacing:.08em;margin-bottom:10px;}
.res-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;}
.res-item{background:rgba(0,0,0,.2);border-radius:8px;padding:12px;}
.res-item .ri-label{font-size:.72rem;color:var(--muted);margin-bottom:4px;}
.res-item .ri-val{font-family:'Syne',sans-serif;font-size:1.05rem;font-weight:700;color:white;}
.res-item.accent .ri-val{color:var(--teal);}

/* TABLE */
.tbl-wrap{overflow-x:auto;margin-top:16px;border-radius:10px;border:1px solid var(--line);}
.tbl-scroll{max-height:320px;overflow-y:auto;}
.tbl-scroll::-webkit-scrollbar{width:3px;}
.tbl-scroll::-webkit-scrollbar-thumb{background:rgba(255,255,255,.1);}
table{width:100%;border-collapse:collapse;font-size:.84rem;}
thead th{background:rgba(0,0,0,.3);color:var(--muted);font-size:.72rem;font-weight:700;
  text-transform:uppercase;letter-spacing:.06em;padding:10px 14px;text-align:right;
  border-bottom:1px solid var(--line);position:sticky;top:0;}
thead th:first-child{text-align:center;}
tbody tr{border-bottom:1px solid rgba(255,255,255,.03);transition:background .2s;}
tbody tr:hover{background:rgba(255,255,255,.03);}
tbody td{padding:10px 14px;text-align:right;color:var(--text);}
tbody td:first-child{text-align:center;color:var(--muted);}

/* STAT CARDS */
.stat-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:14px;margin-bottom:20px;}
.stat-card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:18px;
  transition:border-color .3s;}
.stat-card:hover{border-color:rgba(0,229,204,.3);}
.stat-card .s-label{font-size:.72rem;color:var(--muted);text-transform:uppercase;
  letter-spacing:.07em;margin-bottom:7px;}
.stat-card .s-val{font-family:'Syne',sans-serif;font-size:1.4rem;font-weight:800;color:white;}
.stat-card.hi .s-val{color:var(--teal);}

/* AI CHAT */
.ai-chat-wrap{display:flex;flex-direction:column;height:480px;background:var(--card);
  border:1px solid var(--line);border-radius:16px;overflow:hidden;}
.ai-chat-head{padding:16px 20px;border-bottom:1px solid var(--line);
  display:flex;align-items:center;gap:12px;}
.ai-chat-av{width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,var(--violet),var(--teal));
  display:flex;align-items:center;justify-content:center;font-size:1rem;color:white;}
.ai-chat-info .name{color:white;font-weight:600;font-size:.9rem;}
.ai-chat-info .status{color:var(--muted);font-size:.72rem;display:flex;align-items:center;gap:5px;}
.s-dot{width:6px;height:6px;border-radius:50%;background:#06d6a0;animation:pulse 2s infinite;}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}
.ai-msgs{flex:1;padding:16px;overflow-y:auto;display:flex;flex-direction:column;gap:10px;}
.ai-msgs::-webkit-scrollbar{width:3px;}
.ai-msgs::-webkit-scrollbar-thumb{background:rgba(255,255,255,.1);}
.amsg{padding:10px 14px;border-radius:14px;font-size:.87rem;max-width:85%;line-height:1.5;}
.amsg.user{background:var(--violet);align-self:flex-end;border-bottom-right-radius:3px;}
.amsg.bot{background:rgba(255,255,255,.07);border:1px solid var(--line);
  align-self:flex-start;border-bottom-left-radius:3px;}
.ai-inp-row{display:flex;gap:8px;padding:14px;border-top:1px solid var(--line);
  background:rgba(0,0,0,.2);}
#ai-input{flex:1;background:rgba(255,255,255,.06);border:1px solid var(--line);
  border-radius:20px;color:white;padding:9px 14px;outline:none;
  font-family:'DM Sans',sans-serif;font-size:.87rem;transition:border-color .25s;}
#ai-input:focus{border-color:var(--teal);}
#ai-send{width:38px;height:38px;border-radius:50%;border:none;flex-shrink:0;
  background:var(--teal);color:var(--ink);display:flex;align-items:center;
  justify-content:center;cursor:pointer;font-size:.9rem;transition:all .25s;}
#ai-send:hover{transform:scale(1.1);}
.ai-chips{display:flex;gap:6px;flex-wrap:wrap;padding:0 14px 10px;}
.ai-chip{padding:5px 12px;border-radius:20px;background:rgba(124,92,252,.15);
  border:1px solid rgba(124,92,252,.3);color:#b5a4ff;font-size:.75rem;
  cursor:pointer;transition:all .2s;}
.ai-chip:hover{background:rgba(124,92,252,.3);}

/* SLIDER */
.range-wrap{margin-top:8px;}
input[type=range]{width:100%;-webkit-appearance:none;height:4px;
  background:var(--line);border-radius:2px;outline:none;cursor:pointer;}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;
  border-radius:50%;background:var(--teal);cursor:pointer;border:2px solid var(--ink);}
.range-labels{display:flex;justify-content:space-between;font-size:.72rem;color:var(--muted);margin-top:4px;}

/* DASHBOARD */
.dash-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;}
.chart-card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:22px;}
.chart-card h3{font-family:'Syne',sans-serif;font-size:.95rem;font-weight:700;
  color:white;margin-bottom:16px;display:flex;align-items:center;gap:8px;}
.chart-card h3 i{color:var(--teal);}
.chart-h{height:200px;position:relative;}

/* BADGE */
.badge{display:inline-flex;align-items:center;gap:6px;padding:3px 10px;
  border-radius:20px;font-size:.72rem;font-weight:600;}
.badge-green{background:rgba(6,214,160,.15);border:1px solid rgba(6,214,160,.3);color:#06d6a0;}
.badge-rose{background:rgba(255,101,132,.15);border:1px solid rgba(255,101,132,.3);color:var(--rose);}
.badge-gold{background:rgba(255,209,102,.15);border:1px solid rgba(255,209,102,.3);color:var(--gold);}

/* SLAB TABLE */
.slab-row{display:flex;justify-content:space-between;align-items:center;
  padding:10px 14px;border-radius:8px;margin-bottom:6px;background:rgba(255,255,255,.03);}
.slab-row:hover{background:rgba(255,255,255,.06);}
.slab-range{font-size:.85rem;color:var(--text);}
.slab-rate{font-family:'Syne',sans-serif;font-size:.95rem;font-weight:700;}

/* ERROR */
.err-msg{display:none;color:var(--rose);font-size:.82rem;margin-top:10px;
  padding:9px 14px;background:rgba(255,101,132,.08);border:1px solid rgba(255,101,132,.2);
  border-radius:8px;}
.err-msg.show{display:block;}

/* RESPONSIVE */
@media(max-width:900px){
  .sidebar{transform:translateX(-100%);transition:transform .3s;}
  .sidebar.open{transform:none;}
  .main{margin-left:0;}
  .form-grid.col2,.form-grid.col3{grid-template-columns:1fr;}
  .dash-grid{grid-template-columns:1fr;}
}
@media print{
  nav,.sidebar,.btn-row,.ai-chat-wrap{display:none!important;}
  .main{margin-left:0!important;}
  body{background:white;color:#000;}
  .card,.result-box,.stat-card{background:white!important;border:1px solid #ddd!important;}
}
</style>
</head>
<body>
<div class="blob b1"></div>
<div class="blob b2"></div>

<nav>
  <a href="index.html" class="nav-logo">KUSHAL<em>.</em>P</a>
  <div style="display:flex;align-items:center;gap:10px;">
    <span style="font-size:.8rem;color:var(--muted);display:none;" id="mob-title"></span>
    <a href="index.html" class="nav-back"><i class="fas fa-arrow-left"></i> Portfolio</a>
  </div>
</nav>

<div class="layout">
<!-- SIDEBAR -->
<aside class="sidebar" id="sidebar">
  <div class="sb-section">
    <div class="sb-label">Overview</div>
    <button class="sb-btn active" onclick="show('dashboard')"><i class="fas fa-th-large"></i> Dashboard</button>
    <button class="sb-btn" onclick="show('ai-assistant')"><i class="fas fa-robot"></i> AI Assistant</button>
  </div>
  <div class="sb-section">
    <div class="sb-label">Tax & VAT</div>
    <button class="sb-btn" onclick="show('vat')"><i class="fas fa-receipt"></i> VAT Calculator</button>
    <button class="sb-btn" onclick="show('tds')"><i class="fas fa-percentage"></i> TDS Calculator</button>
    <button class="sb-btn" onclick="show('income-tax')"><i class="fas fa-file-invoice-dollar"></i> Income Tax</button>
    <button class="sb-btn" onclick="show('advance-tax')"><i class="fas fa-calendar-check"></i> Advance Tax</button>
  </div>
  <div class="sb-section">
    <div class="sb-label">Banking & Loans</div>
    <button class="sb-btn" onclick="show('emi')"><i class="fas fa-calculator"></i> EMI Calculator</button>
    <button class="sb-btn" onclick="show('npa')"><i class="fas fa-exclamation-triangle"></i> NPA Tracker</button>
    <button class="sb-btn" onclick="show('bank-recon')"><i class="fas fa-balance-scale"></i> Bank Reconciliation</button>
  </div>
  <div class="sb-section">
    <div class="sb-label">Payroll</div>
    <button class="sb-btn" onclick="show('salary-tax')"><i class="fas fa-user-tie"></i> Salary Tax</button>
    <button class="sb-btn" onclick="show('pf-ssf')"><i class="fas fa-piggy-bank"></i> PF / SSF</button>
    <button class="sb-btn" onclick="show('payslip')"><i class="fas fa-file-alt"></i> Payslip Generator</button>
  </div>
  <div class="sb-section">
    <div class="sb-label">Accounting</div>
    <button class="sb-btn" onclick="show('journal')"><i class="fas fa-book"></i> Journal Voucher</button>
    <button class="sb-btn" onclick="show('depreciation')"><i class="fas fa-chart-line"></i> Depreciation</button>
    <button class="sb-btn" onclick="show('profit-loss')"><i class="fas fa-chart-bar"></i> Profit & Loss</button>
    <button class="sb-btn" onclick="show('balance-sheet')"><i class="fas fa-layer-group"></i> Balance Sheet</button>
  </div>
  <div class="sb-section">
    <div class="sb-label">Utility</div>
    <button class="sb-btn" onclick="show('date-converter')"><i class="fas fa-calendar-alt"></i> BS/AD Converter</button>
    <button class="sb-btn" onclick="show('pan-validator')"><i class="fas fa-id-card"></i> PAN Validator</button>
  </div>
</aside>

<!-- MAIN CONTENT -->
<main class="main">

<!-- ‚îÄ‚îÄ DASHBOARD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel active" id="panel-dashboard">
  <div class="page-hdr">
    <div class="eyebrow">Nepal Accounting Suite</div>
    <h1>AI Accounting Engine</h1>
    <p>FY 2082/83 rules ¬∑ Nepal-specific tools ¬∑ Powered by AI</p>
  </div>
  <div class="stat-row">
    <div class="stat-card hi"><div class="s-label">VAT Rate</div><div class="s-val">13%</div></div>
    <div class="stat-card"><div class="s-label">TDS (Service)</div><div class="s-val">1.5%</div></div>
    <div class="stat-card"><div class="s-label">PF Employee</div><div class="s-val">11%</div></div>
    <div class="stat-card"><div class="s-label">PF Employer</div><div class="s-val">20%</div></div>
    <div class="stat-card"><div class="s-label">Fiscal Year</div><div class="s-val">2082/83</div></div>
  </div>
  <div class="dash-grid">
    <div class="chart-card">
      <h3><i class="fas fa-chart-pie"></i> Income Tax Slabs (Unmarried)</h3>
      <div class="chart-h"><canvas id="slabChart"></canvas></div>
    </div>
    <div class="chart-card">
      <h3><i class="fas fa-list"></i> Quick Reference</h3>
      <div id="quick-ref"></div>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ AI ASSISTANT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-ai-assistant">
  <div class="page-hdr">
    <div class="eyebrow">Smart AI</div>
    <h1>AI Accounting Assistant</h1>
    <p>Ask anything about Nepal accounting, VAT, TDS, tax slabs, EMI calculations</p>
  </div>
  <div class="ai-chat-wrap">
    <div class="ai-chat-head">
      <div class="ai-chat-av"><i class="fas fa-robot"></i></div>
      <div class="ai-chat-info">
        <div class="name">Nepal Accounting AI</div>
        <div class="status"><span class="s-dot"></span> Online ¬∑ FY 2082/83 data loaded</div>
      </div>
    </div>
    <div class="ai-msgs" id="ai-msgs">
      <div class="amsg bot">Namaste! üôè I'm your Nepal Accounting AI assistant. Ask me about VAT, TDS, income tax slabs, EMI calculations, PF/SSF, or any Nepal-specific accounting query!</div>
    </div>
    <div class="ai-chips">
      <span class="ai-chip" onclick="quickAsk('VAT rate in Nepal 2082/83?')">VAT Rate?</span>
      <span class="ai-chip" onclick="quickAsk('TDS rates for different payment types?')">TDS Rates?</span>
      <span class="ai-chip" onclick="quickAsk('Income tax slabs FY 2082/83 for unmarried?')">Tax Slabs?</span>
      <span class="ai-chip" onclick="quickAsk('PF and SSF contribution rates Nepal?')">PF/SSF?</span>
      <span class="ai-chip" onclick="quickAsk('VAT filing deadline Nepal?')">VAT Filing?</span>
    </div>
    <div class="ai-inp-row">
      <input id="ai-input" placeholder="Ask about Nepal accounting‚Ä¶" autocomplete="off">
      <button id="ai-send" onclick="sendAI()"><i class="fas fa-paper-plane"></i></button>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ VAT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-vat">
  <div class="page-hdr"><div class="eyebrow">VAT Tools</div><h1>VAT Calculator</h1><p>Nepal VAT @ 13% ‚Äî Sale, Purchase & Payable</p></div>
  <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:20px;margin-bottom:20px;">
    <!-- Sale -->
    <div class="card">
      <div class="card-title"><i class="fas fa-arrow-up"></i> VAT on Sale</div>
      <div class="form-grid">
        <div class="fg"><label>Amount (excl. VAT)</label>
          <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="vs-amt" placeholder="0"></div>
        </div>
      </div>
      <div class="btn-row"><button class="btn btn-teal" onclick="calcVATSale()"><i class="fas fa-calculator"></i> Calculate</button></div>
      <div class="result-box" id="vs-res">
        <div class="res-title">Sale VAT Result</div>
        <div class="res-grid">
          <div class="res-item"><div class="ri-label">VAT (13%)</div><div class="ri-val" id="vs-vat">‚Äî</div></div>
          <div class="res-item accent"><div class="ri-label">Total Amount</div><div class="ri-val" id="vs-total">‚Äî</div></div>
        </div>
      </div>
    </div>
    <!-- Purchase -->
    <div class="card">
      <div class="card-title"><i class="fas fa-arrow-down"></i> VAT on Purchase</div>
      <div class="form-grid">
        <div class="fg"><label>Amount (incl. VAT)</label>
          <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="vp-amt" placeholder="0"></div>
        </div>
      </div>
      <div class="btn-row"><button class="btn btn-teal" onclick="calcVATPurch()"><i class="fas fa-calculator"></i> Calculate</button></div>
      <div class="result-box" id="vp-res">
        <div class="res-title">Purchase VAT Result</div>
        <div class="res-grid">
          <div class="res-item"><div class="ri-label">VAT Credit</div><div class="ri-val" id="vp-vat">‚Äî</div></div>
          <div class="res-item accent"><div class="ri-label">Net Amount</div><div class="ri-val" id="vp-net">‚Äî</div></div>
        </div>
      </div>
    </div>
    <!-- Payable -->
    <div class="card">
      <div class="card-title"><i class="fas fa-balance-scale"></i> VAT Payable</div>
      <div class="form-grid">
        <div class="fg"><label>Output VAT (Sales)</label>
          <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="vpy-out" placeholder="0"></div>
        </div>
        <div class="fg"><label>Input VAT (Purchases)</label>
          <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="vpy-in" placeholder="0"></div>
        </div>
      </div>
      <div class="btn-row"><button class="btn btn-teal" onclick="calcVATPayable()"><i class="fas fa-calculator"></i> Calculate</button></div>
      <div class="result-box" id="vpy-res">
        <div class="res-title">VAT Payable</div>
        <div class="res-grid">
          <div class="res-item accent"><div class="ri-label">Net VAT Payable</div><div class="ri-val" id="vpy-val">‚Äî</div></div>
        </div>
      </div>
    </div>
  </div>
  <!-- Late penalty -->
  <div class="card">
    <div class="card-title"><i class="fas fa-exclamation-circle"></i> VAT Late Payment Penalty</div>
    <div class="form-grid col2">
      <div class="fg"><label>Outstanding VAT</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="vlp-amt" placeholder="0"></div>
      </div>
      <div class="fg"><label>Days Late</label>
        <input type="number" id="vlp-days" placeholder="0">
      </div>
    </div>
    <div class="btn-row">
      <button class="btn btn-teal" onclick="calcVATLate()"><i class="fas fa-calculator"></i> Calculate Penalty</button>
      <button class="btn btn-ghost" onclick="printResult('vlp-res')"><i class="fas fa-print"></i> Print</button>
    </div>
    <div class="result-box" id="vlp-res">
      <div class="res-title">Late Payment Result</div>
      <div class="res-grid">
        <div class="res-item"><div class="ri-label">Interest (15% p.a.)</div><div class="ri-val" id="vlp-int">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Penalty (1%/month)</div><div class="ri-val" id="vlp-pen">‚Äî</div></div>
        <div class="res-item accent"><div class="ri-label">Total Payable</div><div class="ri-val" id="vlp-tot">‚Äî</div></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ TDS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-tds">
  <div class="page-hdr"><div class="eyebrow">TDS</div><h1>TDS Calculator</h1><p>Nepal TDS rates FY 2082/83</p></div>
  <div class="card">
    <div class="card-title"><i class="fas fa-percentage"></i> Calculate TDS</div>
    <div class="form-grid col2">
      <div class="fg"><label>Payment Type</label>
        <select id="tds-type">
          <option value="1.5">Service (1.5% ‚Äî VAT bill)</option>
          <option value="15">Service (15% ‚Äî no VAT bill)</option>
          <option value="10">Rent (10%)</option>
          <option value="15">Interest / Royalty (15%)</option>
          <option value="5">Dividend (5%)</option>
          <option value="25">Natural Person Contract (25%)</option>
          <option value="1">Land/Building Rent (1%)</option>
        </select>
      </div>
      <div class="fg"><label>Gross Amount</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="tds-amt" placeholder="0"></div>
      </div>
    </div>
    <div class="btn-row">
      <button class="btn btn-teal" onclick="calcTDS()"><i class="fas fa-calculator"></i> Calculate TDS</button>
      <button class="btn btn-ghost" onclick="printResult('tds-res')"><i class="fas fa-print"></i> Print</button>
    </div>
    <div class="result-box" id="tds-res">
      <div class="res-title">TDS Result</div>
      <div class="res-grid">
        <div class="res-item"><div class="ri-label">TDS Deducted</div><div class="ri-val" id="tds-deducted">‚Äî</div></div>
        <div class="res-item accent"><div class="ri-label">Net Payment</div><div class="ri-val" id="tds-net">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Rate Applied</div><div class="ri-val" id="tds-rate-disp">‚Äî</div></div>
      </div>
    </div>
  </div>
  <!-- TDS Reference -->
  <div class="card">
    <div class="card-title"><i class="fas fa-table"></i> TDS Rate Reference</div>
    <div id="tds-ref-table"></div>
  </div>
</div>

<!-- ‚îÄ‚îÄ INCOME TAX ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-income-tax">
  <div class="page-hdr"><div class="eyebrow">Income Tax</div><h1>Income Tax Calculator</h1><p>FY 2082/83 Nepal Income Tax Slabs</p></div>
  <div class="card">
    <div class="card-title"><i class="fas fa-file-invoice-dollar"></i> Calculate Tax</div>
    <div class="form-grid col3">
      <div class="fg"><label>Annual Income</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="it-income" placeholder="0"></div>
      </div>
      <div class="fg"><label>Marital Status</label>
        <select id="it-marital">
          <option value="unmarried">Unmarried</option>
          <option value="married">Married / Couple</option>
        </select>
      </div>
      <div class="fg"><label>Deductions (PF etc.)</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="it-deds" placeholder="0" value="0"></div>
      </div>
    </div>
    <div class="btn-row">
      <button class="btn btn-teal" onclick="calcIT()"><i class="fas fa-calculator"></i> Calculate Tax</button>
      <button class="btn btn-ghost" onclick="printResult('it-res')"><i class="fas fa-print"></i> Print</button>
    </div>
    <div class="result-box" id="it-res">
      <div class="res-title">Income Tax Result</div>
      <div class="res-grid">
        <div class="res-item"><div class="ri-label">Taxable Income</div><div class="ri-val" id="it-taxable">‚Äî</div></div>
        <div class="res-item accent"><div class="ri-label">Annual Tax</div><div class="ri-val" id="it-tax">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Monthly Tax</div><div class="ri-val" id="it-monthly">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Effective Rate</div><div class="ri-val" id="it-eff">‚Äî</div></div>
      </div>
      <div id="it-slab-breakdown" style="margin-top:14px;"></div>
    </div>
  </div>
  <div class="card">
    <div class="card-title"><i class="fas fa-list-ol"></i> Tax Slabs FY 2082/83</div>
    <div id="it-slabs-display"></div>
  </div>
</div>

<!-- ‚îÄ‚îÄ ADVANCE TAX ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-advance-tax">
  <div class="page-hdr"><div class="eyebrow">Advance Tax</div><h1>Advance Tax Estimator</h1><p>Quarterly advance tax: 40% / 70% / 100%</p></div>
  <div class="card">
    <div class="card-title"><i class="fas fa-calendar-check"></i> Calculate Advance Tax</div>
    <div class="form-grid col2">
      <div class="fg"><label>Estimated Annual Tax</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="at-annual" placeholder="0"></div>
      </div>
      <div class="fg"><label>Quarter</label>
        <select id="at-quarter">
          <option value="0.4">Q1 ‚Äî Poush end (40%)</option>
          <option value="0.7">Q2 ‚Äî Chaitra end (70%)</option>
          <option value="1.0">Q3 ‚Äî Ashadh end (100%)</option>
        </select>
      </div>
    </div>
    <div class="btn-row"><button class="btn btn-teal" onclick="calcAT()"><i class="fas fa-calculator"></i> Calculate</button></div>
    <div class="result-box" id="at-res">
      <div class="res-title">Advance Tax</div>
      <div class="res-grid">
        <div class="res-item accent"><div class="ri-label">Amount Due</div><div class="ri-val" id="at-due">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Cumulative %</div><div class="ri-val" id="at-pct">‚Äî</div></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ EMI ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-emi">
  <div class="page-hdr"><div class="eyebrow">Banking</div><h1>EMI Calculator</h1><p>Reducing balance with service & insurance charges</p></div>
  <div class="card">
    <div class="card-title"><i class="fas fa-calculator"></i> Loan Details</div>
    <div class="form-grid col3">
      <div class="fg"><label>Principal Amount</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="e-p" placeholder="0"></div>
      </div>
      <div class="fg"><label>Annual Interest Rate</label>
        <div class="inp-w has-sfx"><input type="number" id="e-r" placeholder="12" step="0.01"><span class="sfx">% p.a.</span></div>
      </div>
      <div class="fg"><label>Tenure</label>
        <div class="inp-w has-sfx"><input type="number" id="e-n" placeholder="36"><span class="sfx">months</span></div>
      </div>
    </div>
    <div class="form-grid col2" style="margin-top:16px;">
      <div class="fg"><label>Service Charge ‚Äî <span id="e-sc-disp">1.30%</span></label>
        <div class="range-wrap"><input type="range" id="e-sc" min="0" max="5" step="0.05" value="1.3"
          oninput="document.getElementById('e-sc-disp').textContent=parseFloat(this.value).toFixed(2)+'%'">
          <div class="range-labels"><span>0%</span><span>5%</span></div>
        </div>
      </div>
      <div class="fg"><label>Insurance Charge ‚Äî <span id="e-ic-disp">0.425%</span>/yr</label>
        <div class="range-wrap"><input type="range" id="e-ic" min="0" max="2" step="0.025" value="0.425"
          oninput="document.getElementById('e-ic-disp').textContent=parseFloat(this.value).toFixed(3)+'%'">
          <div class="range-labels"><span>0%</span><span>2%</span></div>
        </div>
      </div>
    </div>
    <div class="btn-row">
      <button class="btn btn-teal" onclick="calcEMI_tool()"><i class="fas fa-calculator"></i> Calculate EMI</button>
      <button class="btn btn-ghost" onclick="printResult('e-res')"><i class="fas fa-print"></i> Print</button>
    </div>
    <div class="result-box" id="e-res">
      <div class="res-title">EMI Result</div>
      <div class="res-grid">
        <div class="res-item accent"><div class="ri-label">Monthly EMI</div><div class="ri-val" id="e-emi">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Total Interest</div><div class="ri-val" id="e-int">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Service Charge</div><div class="ri-val" id="e-sc-val">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Insurance</div><div class="ri-val" id="e-ic-val">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Total Cost</div><div class="ri-val" id="e-total">‚Äî</div></div>
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-title"><i class="fas fa-table"></i> Amortization Schedule</div>
    <div class="tbl-wrap"><div class="tbl-scroll"><table>
      <thead><tr><th>#</th><th>Date</th><th>Principal</th><th>Interest</th><th>EMI</th><th>Balance</th></tr></thead>
      <tbody id="e-tbody"></tbody>
    </table></div></div>
  </div>
</div>

<!-- ‚îÄ‚îÄ NPA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-npa">
  <div class="page-hdr"><div class="eyebrow">Banking</div><h1>NPA Tracker</h1><p>NRB 2024 classification guidelines</p></div>
  <div class="card">
    <div class="card-title"><i class="fas fa-exclamation-triangle"></i> NPA Classification</div>
    <div class="form-grid col2">
      <div class="fg"><label>Loan Amount</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="npa-amt" placeholder="0"></div>
      </div>
      <div class="fg"><label>Days Overdue</label><input type="number" id="npa-days" placeholder="0"></div>
    </div>
    <div class="btn-row"><button class="btn btn-teal" onclick="calcNPA()"><i class="fas fa-search"></i> Classify</button></div>
    <div class="result-box" id="npa-res">
      <div class="res-title">NPA Classification</div>
      <div class="res-grid">
        <div class="res-item"><div class="ri-label">Classification</div><div class="ri-val" id="npa-class">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Provision Rate</div><div class="ri-val" id="npa-prov-rate">‚Äî</div></div>
        <div class="res-item accent"><div class="ri-label">Provision Amount</div><div class="ri-val" id="npa-prov-amt">‚Äî</div></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ BANK RECON ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-bank-recon">
  <div class="page-hdr"><div class="eyebrow">Banking</div><h1>Bank Reconciliation</h1></div>
  <div class="card">
    <div class="card-title"><i class="fas fa-balance-scale"></i> Reconcile</div>
    <div class="form-grid col2">
      <div class="fg"><label>Bank Statement Balance</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="br-bank" placeholder="0"></div>
      </div>
      <div class="fg"><label>Ledger Balance</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="br-ledger" placeholder="0"></div>
      </div>
      <div class="fg"><label>Outstanding Deposits</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="br-dep" placeholder="0" value="0"></div>
      </div>
      <div class="fg"><label>Outstanding Cheques</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="br-chq" placeholder="0" value="0"></div>
      </div>
    </div>
    <div class="btn-row"><button class="btn btn-teal" onclick="calcBankRecon()"><i class="fas fa-sync"></i> Reconcile</button></div>
    <div class="result-box" id="br-res">
      <div class="res-title">Reconciliation Result</div>
      <div class="res-grid">
        <div class="res-item"><div class="ri-label">Adjusted Bank Balance</div><div class="ri-val" id="br-adj-bank">‚Äî</div></div>
        <div class="res-item accent"><div class="ri-label">Status</div><div class="ri-val" id="br-status">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Difference</div><div class="ri-val" id="br-diff">‚Äî</div></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ SALARY TAX ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-salary-tax">
  <div class="page-hdr"><div class="eyebrow">Payroll</div><h1>Salary Tax Calculator</h1><p>Nepal Income Tax FY 2082/83</p></div>
  <div class="card">
    <div class="card-title"><i class="fas fa-user-tie"></i> Calculate Monthly TDS</div>
    <div class="form-grid col3">
      <div class="fg"><label>Monthly Gross Salary</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="st-gross" placeholder="0"></div>
      </div>
      <div class="fg"><label>Marital Status</label>
        <select id="st-marital"><option value="unmarried">Unmarried</option><option value="married">Married</option></select>
      </div>
      <div class="fg"><label>Monthly PF/Deductions</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="st-deds" placeholder="0" value="0"></div>
      </div>
    </div>
    <div class="btn-row">
      <button class="btn btn-teal" onclick="calcSalaryTax()"><i class="fas fa-calculator"></i> Calculate</button>
      <button class="btn btn-ghost" onclick="printResult('st-res')"><i class="fas fa-print"></i> Print</button>
    </div>
    <div class="result-box" id="st-res">
      <div class="res-title">Salary Tax Result</div>
      <div class="res-grid">
        <div class="res-item"><div class="ri-label">Annual Income</div><div class="ri-val" id="st-annual">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Annual Tax</div><div class="ri-val" id="st-ann-tax">‚Äî</div></div>
        <div class="res-item accent"><div class="ri-label">Monthly TDS</div><div class="ri-val" id="st-monthly">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Net Monthly Take-home</div><div class="ri-val" id="st-net">‚Äî</div></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ PF SSF ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-pf-ssf">
  <div class="page-hdr"><div class="eyebrow">Payroll</div><h1>PF / SSF Calculator</h1><p>Employee 11% ¬∑ Employer 20%</p></div>
  <div class="card">
    <div class="card-title"><i class="fas fa-piggy-bank"></i> Calculate Contributions</div>
    <div class="form-grid col2">
      <div class="fg"><label>Basic Salary</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="pf-basic" placeholder="0"></div>
      </div>
      <div class="fg"><label>Fund Type</label>
        <select id="pf-type">
          <option value="pf">Provident Fund (PF)</option>
          <option value="ssf">Social Security Fund (SSF)</option>
        </select>
      </div>
    </div>
    <div class="btn-row"><button class="btn btn-teal" onclick="calcPF()"><i class="fas fa-calculator"></i> Calculate</button></div>
    <div class="result-box" id="pf-res">
      <div class="res-title">PF / SSF Result</div>
      <div class="res-grid">
        <div class="res-item"><div class="ri-label">Employee (11%)</div><div class="ri-val" id="pf-emp">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Employer (20%)</div><div class="ri-val" id="pf-empl">‚Äî</div></div>
        <div class="res-item accent"><div class="ri-label">Total Contribution</div><div class="ri-val" id="pf-total">‚Äî</div></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ PAYSLIP ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-payslip">
  <div class="page-hdr"><div class="eyebrow">Payroll</div><h1>Payslip Generator</h1></div>
  <div class="card">
    <div class="card-title"><i class="fas fa-file-alt"></i> Employee Details</div>
    <div class="form-grid col2">
      <div class="fg"><label>Employee Name</label><input type="text" id="ps-name" placeholder="Kushal Phuyal"></div>
      <div class="fg"><label>Designation</label><input type="text" id="ps-desig" placeholder="Accountant"></div>
      <div class="fg"><label>Gross Salary</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="ps-gross" placeholder="0"></div>
      </div>
      <div class="fg"><label>PF Deduction</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="ps-pf" placeholder="0" value="0"></div>
      </div>
      <div class="fg"><label>Income Tax (TDS)</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="ps-tax" placeholder="0" value="0"></div>
      </div>
      <div class="fg"><label>Other Deductions</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="ps-other" placeholder="0" value="0"></div>
      </div>
    </div>
    <div class="btn-row">
      <button class="btn btn-teal" onclick="genPayslip()"><i class="fas fa-file-alt"></i> Generate Payslip</button>
      <button class="btn btn-ghost" onclick="printResult('ps-res')"><i class="fas fa-print"></i> Print</button>
    </div>
    <div class="result-box" id="ps-res">
      <div class="res-title">Payslip Summary</div>
      <div id="ps-content"></div>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ JOURNAL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-journal">
  <div class="page-hdr"><div class="eyebrow">Accounting</div><h1>Journal Voucher</h1></div>
  <div class="card">
    <div class="card-title"><i class="fas fa-book"></i> Add Entry</div>
    <div class="form-grid col2">
      <div class="fg"><label>Debit Account</label><input type="text" id="jv-dr" placeholder="Cash A/c"></div>
      <div class="fg"><label>Credit Account</label><input type="text" id="jv-cr" placeholder="Sales A/c"></div>
      <div class="fg"><label>Amount</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="jv-amt" placeholder="0"></div>
      </div>
      <div class="fg"><label>Narration</label><input type="text" id="jv-narr" placeholder="Being‚Ä¶"></div>
    </div>
    <div class="btn-row">
      <button class="btn btn-teal" onclick="addJV()"><i class="fas fa-plus"></i> Add Entry</button>
      <button class="btn btn-ghost" onclick="clearJV()"><i class="fas fa-trash"></i> Clear All</button>
      <button class="btn btn-ghost" onclick="printResult('jv-table-wrap')"><i class="fas fa-print"></i> Print</button>
    </div>
  </div>
  <div class="card" id="jv-table-wrap">
    <div class="card-title"><i class="fas fa-table"></i> Journal Entries</div>
    <div class="tbl-wrap"><table>
      <thead><tr><th>#</th><th style="text-align:left">Debit A/c</th><th style="text-align:left">Credit A/c</th><th>Amount</th><th style="text-align:left">Narration</th></tr></thead>
      <tbody id="jv-tbody"></tbody>
    </table></div>
    <div style="margin-top:12px;text-align:right;font-size:.85rem;color:var(--muted)">
      Total: <span id="jv-total" style="color:var(--teal);font-family:'Syne',sans-serif;font-weight:700">Rs 0.00</span>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ DEPRECIATION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-depreciation">
  <div class="page-hdr"><div class="eyebrow">Accounting</div><h1>Depreciation Calculator</h1><p>WDV method ‚Äî Nepal Income Tax Act</p></div>
  <div class="card">
    <div class="card-title"><i class="fas fa-chart-line"></i> Calculate Depreciation</div>
    <div class="form-grid col3">
      <div class="fg"><label>Asset Cost</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="dep-cost" placeholder="0"></div>
      </div>
      <div class="fg"><label>Asset Type</label>
        <select id="dep-type">
          <option value="5">Building (5%)</option>
          <option value="20">Vehicle (20%)</option>
          <option value="15">Machinery (15%)</option>
          <option value="25">Furniture / Computer (25%)</option>
          <option value="7">Intangibles (7%)</option>
        </select>
      </div>
      <div class="fg"><label>Years</label><input type="number" id="dep-years" placeholder="5"></div>
    </div>
    <div class="btn-row">
      <button class="btn btn-teal" onclick="calcDep()"><i class="fas fa-calculator"></i> Calculate</button>
      <button class="btn btn-ghost" onclick="printResult('dep-table')"><i class="fas fa-print"></i> Print</button>
    </div>
  </div>
  <div class="card" id="dep-table" style="display:none;">
    <div class="card-title"><i class="fas fa-table"></i> WDV Depreciation Schedule</div>
    <div class="tbl-wrap"><table>
      <thead><tr><th>Year</th><th>Opening WDV</th><th>Depreciation</th><th>Closing WDV</th></tr></thead>
      <tbody id="dep-tbody"></tbody>
    </table></div>
  </div>
</div>

<!-- ‚îÄ‚îÄ PROFIT LOSS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-profit-loss">
  <div class="page-hdr"><div class="eyebrow">Financial</div><h1>Profit & Loss Calculator</h1></div>
  <div class="card">
    <div class="card-title"><i class="fas fa-chart-bar"></i> P&L Summary</div>
    <div class="form-grid col2">
      <div class="fg"><label>Total Revenue</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="pl-rev" placeholder="0"></div>
      </div>
      <div class="fg"><label>Total Expenses</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="pl-exp" placeholder="0"></div>
      </div>
      <div class="fg"><label>Tax Rate (%)</label>
        <div class="inp-w has-sfx"><input type="number" id="pl-tax" placeholder="25" value="25"><span class="sfx">%</span></div>
      </div>
    </div>
    <div class="btn-row"><button class="btn btn-teal" onclick="calcPL()"><i class="fas fa-calculator"></i> Calculate</button></div>
    <div class="result-box" id="pl-res">
      <div class="res-title">P&L Result</div>
      <div class="res-grid">
        <div class="res-item"><div class="ri-label">Gross Profit</div><div class="ri-val" id="pl-gross">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Tax Amount</div><div class="ri-val" id="pl-tax-amt">‚Äî</div></div>
        <div class="res-item accent"><div class="ri-label">Net Profit</div><div class="ri-val" id="pl-net">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Profit Margin</div><div class="ri-val" id="pl-margin">‚Äî</div></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ BALANCE SHEET ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-balance-sheet">
  <div class="page-hdr"><div class="eyebrow">Financial</div><h1>Balance Sheet Checker</h1></div>
  <div class="card">
    <div class="card-title"><i class="fas fa-layer-group"></i> Assets = Liabilities + Equity</div>
    <div class="form-grid col3">
      <div class="fg"><label>Total Assets</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="bs-assets" placeholder="0"></div>
      </div>
      <div class="fg"><label>Total Liabilities</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="bs-liab" placeholder="0"></div>
      </div>
      <div class="fg"><label>Equity / Capital</label>
        <div class="inp-w has-pfx"><span class="pfx">Rs</span><input type="number" id="bs-equity" placeholder="0"></div>
      </div>
    </div>
    <div class="btn-row"><button class="btn btn-teal" onclick="calcBS()"><i class="fas fa-check"></i> Check Balance</button></div>
    <div class="result-box" id="bs-res">
      <div class="res-title">Balance Sheet Check</div>
      <div class="res-grid">
        <div class="res-item"><div class="ri-label">Assets</div><div class="ri-val" id="bs-a-disp">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Liab + Equity</div><div class="ri-val" id="bs-le-disp">‚Äî</div></div>
        <div class="res-item accent"><div class="ri-label">Status</div><div class="ri-val" id="bs-status">‚Äî</div></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ DATE CONVERTER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-date-converter">
  <div class="page-hdr"><div class="eyebrow">Utility</div><h1>BS / AD Date Converter</h1><p>Bikram Sambat ‚Üî Anno Domini</p></div>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;">
    <div class="card">
      <div class="card-title"><i class="fas fa-calendar"></i> AD ‚Üí BS</div>
      <div class="form-grid">
        <div class="fg"><label>AD Date</label><input type="date" id="ad-date"></div>
      </div>
      <div class="btn-row"><button class="btn btn-teal" onclick="adToBS()"><i class="fas fa-exchange-alt"></i> Convert</button></div>
      <div class="result-box" id="ad-res">
        <div class="res-title">BS Date</div>
        <div class="res-grid"><div class="res-item accent"><div class="ri-label">Bikram Sambat</div><div class="ri-val" id="ad-bs-result">‚Äî</div></div></div>
      </div>
    </div>
    <div class="card">
      <div class="card-title"><i class="fas fa-calendar-alt"></i> BS ‚Üí AD</div>
      <div class="form-grid col3">
        <div class="fg"><label>BS Year</label><input type="number" id="bs-yr" placeholder="2082" min="2000" max="2100"></div>
        <div class="fg"><label>BS Month</label><input type="number" id="bs-mo" placeholder="1" min="1" max="12"></div>
        <div class="fg"><label>BS Day</label><input type="number" id="bs-dy" placeholder="1" min="1" max="32"></div>
      </div>
      <div class="btn-row"><button class="btn btn-teal" onclick="bsToAD()"><i class="fas fa-exchange-alt"></i> Convert</button></div>
      <div class="result-box" id="bs-res2">
        <div class="res-title">AD Date</div>
        <div class="res-grid"><div class="res-item accent"><div class="ri-label">Anno Domini</div><div class="ri-val" id="bs-ad-result">‚Äî</div></div></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ PAN VALIDATOR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="tool-panel" id="panel-pan-validator">
  <div class="page-hdr"><div class="eyebrow">Utility</div><h1>PAN Validator</h1><p>Nepal IRD PAN number validation</p></div>
  <div class="card">
    <div class="card-title"><i class="fas fa-id-card"></i> Validate PAN</div>
    <div class="form-grid">
      <div class="fg"><label>PAN Number</label>
        <input type="text" id="pan-val" placeholder="9-digit number" maxlength="9">
      </div>
    </div>
    <div class="btn-row"><button class="btn btn-teal" onclick="validatePAN()"><i class="fas fa-check"></i> Validate</button></div>
    <div class="result-box" id="pan-res">
      <div class="res-title">PAN Validation Result</div>
      <div class="res-grid">
        <div class="res-item accent"><div class="ri-label">Status</div><div class="ri-val" id="pan-status">‚Äî</div></div>
        <div class="res-item"><div class="ri-label">Type</div><div class="ri-val" id="pan-type">‚Äî</div></div>
      </div>
    </div>
    <div style="margin-top:18px;padding:14px;background:rgba(255,255,255,.03);border-radius:10px;font-size:.83rem;color:var(--muted);line-height:1.7;">
      <strong style="color:white;">PAN Format:</strong> 9-digit number. Verify actual registration at <a href="https://ird.gov.np" target="_blank" style="color:var(--teal);">ird.gov.np</a>
    </div>
  </div>
</div>

</main>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NAVIGATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function show(id){
  document.querySelectorAll('.tool-panel').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.sb-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById('panel-'+id).classList.add('active');
  event.currentTarget.classList.add('active');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HELPERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function fmt(n){
  if(isNaN(n)) return '‚Äî';
  const parts=Math.abs(n).toFixed(2).split('.');
  let int=parts[0],dec=parts[1],result='';
  if(int.length<=3){result=int;}
  else{result=int.slice(-3);let rem=int.slice(0,int.length-3);
    while(rem.length>2){result=rem.slice(-2)+','+result;rem=rem.slice(0,rem.length-2);}
    if(rem.length)result=rem+','+result;}
  return (n<0?'-':'')+'Rs '+result+'.'+dec;
}
function showRes(id){document.getElementById(id).classList.add('show');}
function printResult(id){
  const el=document.getElementById(id);
  const w=window.open('','_blank');
  w.document.write('<html><head><title>Print</title><style>body{font-family:Arial,sans-serif;padding:20px;}table{border-collapse:collapse;width:100%;}th,td{border:1px solid #ddd;padding:8px;}</style></head><body>'+el.innerHTML+'</body></html>');
  w.print();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// VAT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calcVATSale(){
  const a=parseFloat(document.getElementById('vs-amt').value)||0;
  const vat=a*0.13;
  document.getElementById('vs-vat').textContent=fmt(vat);
  document.getElementById('vs-total').textContent=fmt(a+vat);
  showRes('vs-res');
}
function calcVATPurch(){
  const tot=parseFloat(document.getElementById('vp-amt').value)||0;
  const vat=tot*0.13/1.13;
  document.getElementById('vp-vat').textContent=fmt(vat);
  document.getElementById('vp-net').textContent=fmt(tot-vat);
  showRes('vp-res');
}
function calcVATPayable(){
  const out=parseFloat(document.getElementById('vpy-out').value)||0;
  const inp=parseFloat(document.getElementById('vpy-in').value)||0;
  const payable=out-inp;
  const el=document.getElementById('vpy-val');
  el.textContent=fmt(payable);
  el.style.color=payable>0?'var(--rose)':'var(--green)';
  showRes('vpy-res');
}
function calcVATLate(){
  const amt=parseFloat(document.getElementById('vlp-amt').value)||0;
  const days=parseFloat(document.getElementById('vlp-days').value)||0;
  const interest=amt*0.15/365*days;
  const penalty=amt*0.01*(days/30);
  document.getElementById('vlp-int').textContent=fmt(interest);
  document.getElementById('vlp-pen').textContent=fmt(penalty);
  document.getElementById('vlp-tot').textContent=fmt(interest+penalty);
  showRes('vlp-res');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TDS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calcTDS(){
  const rate=parseFloat(document.getElementById('tds-type').value);
  const amt=parseFloat(document.getElementById('tds-amt').value)||0;
  const tds=amt*(rate/100);
  document.getElementById('tds-deducted').textContent=fmt(tds);
  document.getElementById('tds-net').textContent=fmt(amt-tds);
  document.getElementById('tds-rate-disp').textContent=rate+'%';
  showRes('tds-res');
}
function buildTDSRef(){
  const rates=[
    ['Service (with VAT bill)','1.5%'],
    ['Service (without VAT bill)','15%'],
    ['Rent','10%'],
    ['Interest / Royalty','15%'],
    ['Dividend','5%'],
    ['Natural Person Contract','25%'],
    ['Land/Building Rent','1%'],
    ['Salary (slab-based)','Slab'],
  ];
  let html='<div class="tbl-wrap"><table><thead><tr><th style="text-align:left">Payment Type</th><th>Rate</th></tr></thead><tbody>';
  rates.forEach(([t,r])=>html+=`<tr><td style="text-align:left;color:var(--text)">${t}</td><td>${r}</td></tr>`);
  html+='</tbody></table></div>';
  document.getElementById('tds-ref-table').innerHTML=html;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INCOME TAX
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const IT_SLABS={
  unmarried:[[500000,0.01],[200000,0.10],[300000,0.20],[1000000,0.30],[3000000,0.36],[Infinity,0.39]],
  married:  [[600000,0.01],[200000,0.10],[300000,0.20],[900000,0.30],[3000000,0.36],[Infinity,0.39]]
};
function calcITAmount(income,marital){
  let tax=0,rem=income,breakdown=[];
  IT_SLABS[marital].forEach(([bracket,rate])=>{
    if(rem<=0)return;
    const taxable=Math.min(rem,bracket===Infinity?rem:bracket);
    const t=taxable*rate;
    breakdown.push({bracket,rate,taxable,t});
    tax+=t; rem-=taxable;
  });
  return{tax,breakdown};
}
function calcIT(){
  const income=parseFloat(document.getElementById('it-income').value)||0;
  const marital=document.getElementById('it-marital').value;
  const deds=parseFloat(document.getElementById('it-deds').value)||0;
  const taxable=Math.max(0,income-deds);
  const {tax,breakdown}=calcITAmount(taxable,marital);
  document.getElementById('it-taxable').textContent=fmt(taxable);
  document.getElementById('it-tax').textContent=fmt(tax);
  document.getElementById('it-monthly').textContent=fmt(tax/12);
  document.getElementById('it-eff').textContent=income>0?((tax/income)*100).toFixed(2)+'%':'0%';
  let bhtml='<div style="margin-top:4px;">';
  breakdown.forEach(b=>{if(b.taxable>0)bhtml+=`<div class="slab-row"><span class="slab-range">${fmt(b.taxable)} @ ${(b.rate*100).toFixed(0)}%</span><span class="slab-rate" style="color:var(--teal)">${fmt(b.t)}</span></div>`;});
  bhtml+='</div>';
  document.getElementById('it-slab-breakdown').innerHTML=bhtml;
  showRes('it-res');
}
function buildITSlabs(){
  const labels=['Up to Rs 5L','5L‚Äì7L','7L‚Äì10L','10L‚Äì20L','20L‚Äì50L','Above 50L'];
  const rates=[1,10,20,30,36,39];
  const colors=['var(--green)','var(--teal)','var(--gold)','var(--violet)','var(--rose)','#ff4500'];
  let html='';
  labels.forEach((l,i)=>html+=`<div class="slab-row"><span class="slab-range">${l}</span><span class="slab-rate" style="color:${colors[i]}">${rates[i]}%</span></div>`);
  document.getElementById('it-slabs-display').innerHTML=html;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ADVANCE TAX
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calcAT(){
  const annual=parseFloat(document.getElementById('at-annual').value)||0;
  const pct=parseFloat(document.getElementById('at-quarter').value);
  document.getElementById('at-due').textContent=fmt(annual*pct);
  document.getElementById('at-pct').textContent=(pct*100)+'%';
  showRes('at-res');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// EMI
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calcEMI_tool(){
  const p=parseFloat(document.getElementById('e-p').value)||0;
  const annualR=parseFloat(document.getElementById('e-r').value)||0;
  const n=parseInt(document.getElementById('e-n').value)||0;
  const sc=parseFloat(document.getElementById('e-sc').value)/100;
  const ic=parseFloat(document.getElementById('e-ic').value)/100;
  if(!p||!annualR||!n)return;
  const r=annualR/12/100;
  const emi=p*r*Math.pow(1+r,n)/(Math.pow(1+r,n)-1);
  const totalInt=emi*n-p;
  const scAmt=p*sc, icAmt=p*ic*Math.ceil(n/12);
  document.getElementById('e-emi').textContent=fmt(emi);
  document.getElementById('e-int').textContent=fmt(totalInt);
  document.getElementById('e-sc-val').textContent=fmt(scAmt);
  document.getElementById('e-ic-val').textContent=fmt(icAmt);
  document.getElementById('e-total').textContent=fmt(p+totalInt+scAmt+icAmt);
  showRes('e-res');
  let rem=p,rows='',dt=new Date();
  for(let i=1;i<=n;i++){
    const ip=rem*r,pp=emi-ip;rem-=pp;
    const d=new Date(dt);d.setMonth(d.getMonth()+i-1);
    rows+=`<tr><td>${i}</td><td style="text-align:center;color:var(--muted)">${d.toISOString().split('T')[0]}</td><td style="color:var(--green)">${fmt(pp)}</td><td style="color:var(--rose)">${fmt(ip)}</td><td style="color:var(--teal);font-weight:600">${fmt(emi)}</td><td style="color:var(--muted)">${fmt(Math.max(0,rem))}</td></tr>`;
  }
  document.getElementById('e-tbody').innerHTML=rows;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NPA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calcNPA(){
  const amt=parseFloat(document.getElementById('npa-amt').value)||0;
  const days=parseFloat(document.getElementById('npa-days').value)||0;
  let cls,prov,color;
  if(days<30){cls='Pass / Performing';prov=0.01;color='var(--green)';}
  else if(days<90){cls='Watchlist';prov=0.05;color='var(--gold)';}
  else if(days<180){cls='Substandard';prov=0.25;color='var(--rose)';}
  else if(days<365){cls='Doubtful';prov=0.50;color='var(--rose)';}
  else{cls='Bad / Loss';prov=1.0;color='#ff4500';}
  const el=document.getElementById('npa-class');
  el.textContent=cls; el.style.color=color;
  document.getElementById('npa-prov-rate').textContent=(prov*100)+'%';
  document.getElementById('npa-prov-amt').textContent=fmt(amt*prov);
  showRes('npa-res');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// BANK RECON
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calcBankRecon(){
  const bank=parseFloat(document.getElementById('br-bank').value)||0;
  const ledger=parseFloat(document.getElementById('br-ledger').value)||0;
  const dep=parseFloat(document.getElementById('br-dep').value)||0;
  const chq=parseFloat(document.getElementById('br-chq').value)||0;
  const adjBank=bank+dep-chq;
  const diff=adjBank-ledger;
  document.getElementById('br-adj-bank').textContent=fmt(adjBank);
  const statusEl=document.getElementById('br-status');
  statusEl.textContent=Math.abs(diff)<0.01?'‚úì Reconciled':'‚úó Difference';
  statusEl.style.color=Math.abs(diff)<0.01?'var(--green)':'var(--rose)';
  document.getElementById('br-diff').textContent=fmt(diff);
  showRes('br-res');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SALARY TAX
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calcSalaryTax(){
  const monthly=parseFloat(document.getElementById('st-gross').value)||0;
  const marital=document.getElementById('st-marital').value;
  const deds=parseFloat(document.getElementById('st-deds').value)||0;
  const annual=monthly*12;
  const taxable=Math.max(0,annual-deds*12);
  const {tax}=calcITAmount(taxable,marital);
  const monthlyTDS=tax/12;
  document.getElementById('st-annual').textContent=fmt(annual);
  document.getElementById('st-ann-tax').textContent=fmt(tax);
  document.getElementById('st-monthly').textContent=fmt(monthlyTDS);
  document.getElementById('st-net').textContent=fmt(monthly-monthlyTDS-deds);
  showRes('st-res');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PF / SSF
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calcPF(){
  const basic=parseFloat(document.getElementById('pf-basic').value)||0;
  const emp=basic*0.11, empl=basic*0.20;
  document.getElementById('pf-emp').textContent=fmt(emp);
  document.getElementById('pf-empl').textContent=fmt(empl);
  document.getElementById('pf-total').textContent=fmt(emp+empl);
  showRes('pf-res');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PAYSLIP
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function genPayslip(){
  const name=document.getElementById('ps-name').value||'‚Äî';
  const desig=document.getElementById('ps-desig').value||'‚Äî';
  const gross=parseFloat(document.getElementById('ps-gross').value)||0;
  const pf=parseFloat(document.getElementById('ps-pf').value)||0;
  const tax=parseFloat(document.getElementById('ps-tax').value)||0;
  const other=parseFloat(document.getElementById('ps-other').value)||0;
  const net=gross-pf-tax-other;
  const html=`<table style="width:100%;font-size:.85rem;border-collapse:collapse;margin-top:8px;">
    <tr style="border-bottom:1px solid var(--line)"><td style="padding:8px 0;color:var(--muted)">Employee</td><td style="text-align:right;color:white">${name}</td></tr>
    <tr style="border-bottom:1px solid var(--line)"><td style="padding:8px 0;color:var(--muted)">Designation</td><td style="text-align:right;color:white">${desig}</td></tr>
    <tr style="border-bottom:1px solid var(--line)"><td style="padding:8px 0;color:var(--muted)">Gross Salary</td><td style="text-align:right;color:white">${fmt(gross)}</td></tr>
    <tr style="border-bottom:1px solid var(--line)"><td style="padding:8px 0;color:var(--muted)">PF Deduction</td><td style="text-align:right;color:var(--rose)">- ${fmt(pf)}</td></tr>
    <tr style="border-bottom:1px solid var(--line)"><td style="padding:8px 0;color:var(--muted)">Income Tax (TDS)</td><td style="text-align:right;color:var(--rose)">- ${fmt(tax)}</td></tr>
    <tr style="border-bottom:1px solid var(--line)"><td style="padding:8px 0;color:var(--muted)">Other Deductions</td><td style="text-align:right;color:var(--rose)">- ${fmt(other)}</td></tr>
    <tr><td style="padding:8px 0;font-weight:700;color:white">Net Take-Home</td><td style="text-align:right;font-family:'Syne',sans-serif;font-size:1.1rem;color:var(--teal)">${fmt(net)}</td></tr>
  </table>`;
  document.getElementById('ps-content').innerHTML=html;
  showRes('ps-res');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// JOURNAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let jvEntries=[],jvNum=0;
function addJV(){
  const dr=document.getElementById('jv-dr').value;
  const cr=document.getElementById('jv-cr').value;
  const amt=parseFloat(document.getElementById('jv-amt').value)||0;
  const narr=document.getElementById('jv-narr').value;
  if(!dr||!cr||!amt)return;
  jvEntries.push({dr,cr,amt,narr});
  jvNum++;
  renderJV();
  ['jv-dr','jv-cr','jv-amt','jv-narr'].forEach(id=>document.getElementById(id).value='');
}
function renderJV(){
  let total=0,rows='';
  jvEntries.forEach((e,i)=>{total+=e.amt;
    rows+=`<tr><td>${i+1}</td><td style="text-align:left">${e.dr} Dr</td><td style="text-align:left">${e.cr} Cr</td><td>${fmt(e.amt)}</td><td style="text-align:left;color:var(--muted)">${e.narr}</td></tr>`;});
  document.getElementById('jv-tbody').innerHTML=rows;
  document.getElementById('jv-total').textContent=fmt(total);
}
function clearJV(){jvEntries=[];renderJV();}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DEPRECIATION (WDV)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calcDep(){
  const cost=parseFloat(document.getElementById('dep-cost').value)||0;
  const rate=parseFloat(document.getElementById('dep-type').value)/100;
  const years=parseInt(document.getElementById('dep-years').value)||5;
  let wdv=cost,rows='';
  for(let y=1;y<=years;y++){
    const dep=wdv*rate;
    rows+=`<tr><td>${y}</td><td>${fmt(wdv)}</td><td style="color:var(--rose)">${fmt(dep)}</td><td style="color:var(--teal)">${fmt(wdv-dep)}</td></tr>`;
    wdv-=dep;
  }
  document.getElementById('dep-tbody').innerHTML=rows;
  document.getElementById('dep-table').style.display='block';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// P&L
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calcPL(){
  const rev=parseFloat(document.getElementById('pl-rev').value)||0;
  const exp=parseFloat(document.getElementById('pl-exp').value)||0;
  const taxRate=parseFloat(document.getElementById('pl-tax').value)||0;
  const gross=rev-exp;
  const taxAmt=Math.max(0,gross)*(taxRate/100);
  const net=gross-taxAmt;
  document.getElementById('pl-gross').textContent=fmt(gross);
  document.getElementById('pl-tax-amt').textContent=fmt(taxAmt);
  const netEl=document.getElementById('pl-net');
  netEl.textContent=fmt(net);
  netEl.style.color=net>=0?'var(--green)':'var(--rose)';
  document.getElementById('pl-margin').textContent=rev>0?((net/rev)*100).toFixed(2)+'%':'0%';
  showRes('pl-res');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// BALANCE SHEET
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calcBS(){
  const a=parseFloat(document.getElementById('bs-assets').value)||0;
  const l=parseFloat(document.getElementById('bs-liab').value)||0;
  const e=parseFloat(document.getElementById('bs-equity').value)||0;
  const le=l+e,diff=Math.abs(a-le);
  document.getElementById('bs-a-disp').textContent=fmt(a);
  document.getElementById('bs-le-disp').textContent=fmt(le);
  const statusEl=document.getElementById('bs-status');
  statusEl.textContent=diff<0.01?'‚úì Balanced':'‚úó Imbalanced ('+fmt(diff)+')';
  statusEl.style.color=diff<0.01?'var(--green)':'var(--rose)';
  showRes('bs-res');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DATE CONVERTER (simplified)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function adToBS(){
  const d=new Date(document.getElementById('ad-date').value);
  if(isNaN(d)){return;}
  // BS = AD + 56 years 8 months 15 days approx
  const bsYear=d.getFullYear()+56;
  const bsMonth=d.getMonth()+9>12?d.getMonth()-3:d.getMonth()+9;
  const bsDay=d.getDate()+15>30?d.getDate()-15:d.getDate()+15;
  document.getElementById('ad-bs-result').textContent=`${bsYear}-${String(bsMonth).padStart(2,'0')}-${String(bsDay).padStart(2,'0')} (Approximate)`;
  showRes('ad-res');
}
function bsToAD(){
  const y=parseInt(document.getElementById('bs-yr').value)||2082;
  const m=parseInt(document.getElementById('bs-mo').value)||1;
  const d=parseInt(document.getElementById('bs-dy').value)||1;
  const adYear=y-57;
  const adMonth=m-3<=0?m+9:m-3;
  const adDay=d-15<=0?d+15:d-15;
  document.getElementById('bs-ad-result').textContent=`${adYear}-${String(adMonth).padStart(2,'0')}-${String(adDay).padStart(2,'0')} (Approximate)`;
  showRes('bs-res2');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PAN VALIDATOR
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function validatePAN(){
  const pan=document.getElementById('pan-val').value.trim();
  const valid=pan.length===9&&/^\d{9}$/.test(pan);
  document.getElementById('pan-status').textContent=valid?'‚úì Valid Format':'‚úó Invalid Format';
  document.getElementById('pan-status').style.color=valid?'var(--green)':'var(--rose)';
  let type='‚Äî';
  if(valid){const f=parseInt(pan[0]);if(f>=1&&f<=3)type='Individual';else if(f>=4&&f<=6)type='Company';else type='Organization';}
  document.getElementById('pan-type').textContent=type;
  showRes('pan-res');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// AI CHAT (Cloudflare Worker)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const aiMsgs=document.getElementById('ai-msgs');
const aiInput=document.getElementById('ai-input');
function quickAsk(q){aiInput.value=q;sendAI();}
async function sendAI(){
  const text=aiInput.value.trim();
  if(!text)return;
  aiInput.value='';
  aiMsgs.innerHTML+=`<div class="amsg user">${text}</div>`;
  aiMsgs.scrollTop=aiMsgs.scrollHeight;
  const tid='t'+Date.now();
  aiMsgs.innerHTML+=`<div class="amsg bot" id="${tid}"><i class="fas fa-circle-notch fa-spin" style="color:var(--teal)"></i> Thinking...</div>`;
  aiMsgs.scrollTop=aiMsgs.scrollHeight;
  try{
    const res=await fetch('https://morning-bush-8bd5.kushalphuyal.workers.dev/',{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({message:'Nepal accounting question: '+text})
    });
    const reply=await res.text();
    document.getElementById(tid).innerHTML=reply||'No response received.';
  }catch(e){
    document.getElementById(tid).innerHTML='‚ö†Ô∏è Could not connect. Check your Cloudflare Worker. <a href="https://wa.me/9779863970493" target="_blank" style="color:var(--teal)">WhatsApp</a>';
  }
  aiMsgs.scrollTop=aiMsgs.scrollHeight;
}
aiInput.addEventListener('keypress',e=>{if(e.key==='Enter')sendAI();});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DASHBOARD CHART
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function buildDashboard(){
  new Chart(document.getElementById('slabChart'),{
    type:'doughnut',
    data:{
      labels:['1%','10%','20%','30%','36%','39%'],
      datasets:[{data:[500000,200000,300000,1000000,3000000,2000000],
        backgroundColor:['#06d6a0','#00e5cc','#ffd166','#7c5cfc','#ff6584','#ff4500'],
        borderColor:'#0e1428',borderWidth:3}]
    },
    options:{cutout:'65%',responsive:true,maintainAspectRatio:false,
      plugins:{legend:{labels:{color:'#5a6080',font:{size:11}}}}}
  });
  document.getElementById('quick-ref').innerHTML=`
    <div class="slab-row"><span class="slab-range">VAT Rate</span><span class="slab-rate" style="color:var(--teal)">13%</span></div>
    <div class="slab-row"><span class="slab-range">TDS ‚Äì Service (VAT bill)</span><span class="slab-rate" style="color:var(--teal)">1.5%</span></div>
    <div class="slab-row"><span class="slab-range">TDS ‚Äì Rent</span><span class="slab-rate" style="color:var(--teal)">10%</span></div>
    <div class="slab-row"><span class="slab-range">TDS ‚Äì Interest</span><span class="slab-rate" style="color:var(--teal)">15%</span></div>
    <div class="slab-row"><span class="slab-range">PF Employee</span><span class="slab-rate" style="color:var(--violet)">11%</span></div>
    <div class="slab-row"><span class="slab-range">PF Employer</span><span class="slab-rate" style="color:var(--violet)">20%</span></div>
    <div class="slab-row"><span class="slab-range">Corporate Tax</span><span class="slab-rate" style="color:var(--gold)">25%</span></div>
  `;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
buildDashboard();
buildTDSRef();
buildITSlabs();
</script>
</body>
</html>
